{
  "info": {
    "name": "AuthFileSSEApi",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8000"
    },
    {
      "key": "keycloakUrl",
      "value": "http://localhost:8180"
    },
    {
      "key": "keycloakRealm",
      "value": "master"
    },
    {
      "key": "keycloakClientId",
      "value": "admin-cli"
    },
    {
      "key": "keycloakClientSecret",
      "value": "12345678-1234-1234-1234-123456789012"
    },
    {
      "key": "keycloakAdminUser",
      "value": "admin"
    },
    {
      "key": "keycloakAdminPassword",
      "value": "admin"
    },
    {
      "key": "staticToken",
      "value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJiQ2doemZDRl93T0Zkcl9SQTNnZmtsWVRfQjRMd2dRYzdWWWNCSHg3RW44In0.eyJleHAiOjE3MjkyNzkyMTksImlhdCI6MTcyOTI3OTE1OSwianRpIjoiNDgxOWI0MWItOWRiOC00NTc1LThiYjYtMzY5ZWVjODMwMWVjIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MTgwL3JlYWxtcy9tYXN0ZXIiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJhZG1pbi1jbGkiLCJzaWQiOiI1OTc5ODlkMS0yYmVjLTQ4NGMtYjkwYS03ZWEwOTIyNzNlYWQiLCJzY29wZSI6ImVtYWlsIHByb2ZpbGUifQ.pJW_a8ATkyZmy51f52xHVcfEnC_A6A3raUrOhBrEvIpEGonS1ejfCtI7LllDYcdJujOfZOGsO5En3P7kE_YFF-x98TYyuPJlft6XtPTWoXnjt9thkoFFnYJbKoDqU_x0kHPgKyjq48EzyZnkzc1WWZXUEatwY_OhvlfgMSLtiUFtVwI8cpvQuHC1Reb0WmIeHI965zkvCHH-ZKkYtTPsKie1d3kmBaxqTmldeQtevqqwD0U4_u3tZRnz5bBU_ob6y6J6uNIPD9n7pWU-EXM1QFqo4Vx9iQE3XGrTrGVAMrTecUiiN8tKQXJMMkp_5cRzilkSIZB8_Lmy2IuYCuuCOQ"
    }
  ],
  "item": [
    {
      "name": "Login",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "var jsonData = pm.response.json();",
              "pm.environment.set(\"authToken\", jsonData.access_token);",
              "pm.environment.set(\"refreshToken\", jsonData.refresh_token);"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/x-www-form-urlencoded"
          }
        ],
        "body": {
          "mode": "urlencoded",
          "urlencoded": [
            {
              "key": "grant_type",
              "value": "password"
            },
            {
              "key": "client_id",
              "value": "{{keycloakClientId}}"
            },
            {
              "key": "client_secret",
              "value": "{{keycloakClientSecret}}"
            },
            {
              "key": "username",
              "value": "{{keycloakAdminUser}}"
            },
            {
              "key": "password",
              "value": "{{keycloakAdminPassword}}"
            }
          ]
        },
        "url": {
          "raw": "{{keycloakUrl}}/realms/{{keycloakRealm}}/protocol/openid-connect/token",
          "host": [
            "{{keycloakUrl}}"
          ],
          "path": [
            "realms",
            "{{keycloakRealm}}",
            "protocol",
            "openid-connect",
            "token"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Check Token",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{staticToken}}"
          }
        ],
        "url": {
          "raw": "{{keycloakUrl}}/realms/{{keycloakRealm}}/protocol/openid-connect/userinfo",
          "host": [
            "{{keycloakUrl}}"
          ],
          "path": [
            "realms",
            "{{keycloakRealm}}",
            "protocol",
            "openid-connect",
            "userinfo"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Refresh Token",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/x-www-form-urlencoded"
          }
        ],
        "body": {
          "mode": "urlencoded",
          "urlencoded": [
            {
              "key": "grant_type",
              "value": "refresh_token"
            },
            {
              "key": "client_id",
              "value": "{{keycloakClientId}}"
            },
            {
              "key": "client_secret",
              "value": "{{keycloakClientSecret}}"
            },
            {
              "key": "refresh_token",
              "value": "{{refreshToken}}"
            }
          ]
        },
        "url": {
          "raw": "{{keycloakUrl}}/realms/{{keycloakRealm}}/protocol/openid-connect/token",
          "host": [
            "{{keycloakUrl}}"
          ],
          "path": [
            "realms",
            "{{keycloakRealm}}",
            "protocol",
            "openid-connect",
            "token"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Logout",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/x-www-form-urlencoded"
          }
        ],
        "body": {
          "mode": "urlencoded",
          "urlencoded": [
            {
              "key": "refresh_token",
              "value": "{{refreshToken}}"
            },
            {
              "key": "client_id",
              "value": "{{keycloakClientId}}"
            },
            {
              "key": "client_secret",
              "value": "{{keycloakClientSecret}}"
            }
          ]
        },
        "url": {
          "raw": "{{keycloakUrl}}/realms/{{keycloakRealm}}/protocol/openid-connect/logout",
          "host": [
            "{{keycloakUrl}}"
          ],
          "path": [
            "realms",
            "{{keycloakRealm}}",
            "protocol",
            "openid-connect",
            "logout"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Upload File",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{staticToken}}"
          }
        ],
        "body": {
          "mode": "formdata",
          "formdata": [
            {
              "key": "file",
              "type": "file",
              "src": "/path/to/test.txt"
            }
          ]
        },
        "url": {
          "raw": "{{baseUrl}}/api/v1/upload",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "api",
            "v1",
            "upload"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Download File",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{staticToken}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/download/test",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "api",
            "v1",
            "download",
            "test"
          ]
        }
      },
      "response": []
    },
    {
      "name": "SSE (Server-Sent Events)",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "Bearer {{staticToken}}"
          },
          {
            "key": "Accept",
            "value": "text/event-stream"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/v1/events",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "api",
            "v1",
            "events"
          ]
        }
      },
      "response": []
    }
  ]
}